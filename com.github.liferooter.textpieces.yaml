app-id: com.github.liferooter.textpieces
runtime: org.gnome.Platform
runtime-version: '41'
sdk: org.gnome.Sdk
command: textpieces
finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri
  - --filesystem=~/.local/share/textpieces:create
  - --talk-name=org.freedesktop.Flatpak
cleanup:
  - /include
  - /lib/pkgconfig
  - /man
  - /share/doc
  - are/gt
  - /share/pkgconfig
  - /share/vala
  - '*.la'
  - '*.a'
modules:

- name: textpieces
  builddir: true
  buildsystem: meson
  sources:
    - type: git
      url: https://github.com/liferooter/textpieces
      tag: v3.0.1
      commit: 630323b4ba75f1b8fd144cbdecc25f8bd1f9abca
  modules:

  - name: libadwaita
    buildsystem: meson
    config-opts:
    - -Dexamples=false
    - -Dtests=false
    sources:
    - type: git
      url: https://gitlab.gnome.org/GNOME/libadwaita.git
      commit: 12a10b320300ec32d480c29f26ae55c1d4b2a8b7
    modules:
    - name: libsass
      buildsystem: meson
      sources:
      - type: git
        url: https://github.com/lazka/libsass.git
        branch: meson

    - name: sassc
      buildsystem: meson
      sources:
      - type: git
        url: https://github.com/lazka/sassc.git
        branch: meson

  - name: gtksourceview
    buildsystem: meson
    config-opts:
    - -Dtests=false
    - -Dexamples=false
    sources:
    - type: archive
      url: https://download.gnome.org/sources/gtksourceview/5.2/gtksourceview-5.2.0.tar.xz
      sha256: c9b34fa02654f56ce22fa08827d89db4ba81631b2e6d7d31ea65d13c729430e9

  - name: python3-pyyaml
    buildsystem: simple
    build-commands:
    - pip3 install --verbose --exists-action=i --no-index --find-links="file://${PWD}"
      --prefix=${FLATPAK_DEST} "pyyaml" --no-build-isolation
    sources:
    - type: file
      url: https://files.pythonhosted.org/packages/36/2b/61d51a2c4f25ef062ae3f74576b01638bebad5e045f747ff12643df63844/PyYAML-6.0.tar.gz
      sha256: 68fb519c14306fec9720a2a5b45bc9f0c8d1b9c72adf45c37baedfcd949c35a2
